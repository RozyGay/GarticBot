<Window x:Class="GarticBot.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="GarticBot"
        Height="640"
        Width="480"
        MinHeight="580"
        MinWidth="460"
        Icon="/favicon.ico"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="#0C0F1D">
    <Window.Resources>
        <SolidColorBrush x:Key="AccentBrush" Color="#5865F2"/>
        <SolidColorBrush x:Key="AccentBrushHover" Color="#6C74F6"/>
        <SolidColorBrush x:Key="AccentBrushPressed" Color="#454FD6"/>
        <SolidColorBrush x:Key="CardBrush" Color="#1A2033"/>
        <SolidColorBrush x:Key="ButtonBrush" Color="#242A3E"/>
        <SolidColorBrush x:Key="ButtonHoverBrush" Color="#2F3653"/>
        <SolidColorBrush x:Key="ButtonPressedBrush" Color="#1F2438"/>
        <SolidColorBrush x:Key="SubtleTextBrush" Color="#9AA2C1"/>
        
        <Storyboard x:Key="ButtonHoverStoryboard">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" To="0.9" Duration="0:0:0.2"/>
        </Storyboard>

        <Style x:Key="CardBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="CornerRadius" Value="14"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadow Color="#000000" BlurRadius="8" ShadowDepth="0" Opacity="0.3"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <Style x:Key="CaptionTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource SubtleTextBrush}"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style x:Key="FlatButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ButtonBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8" BorderThickness="0">
                            <Border.Effect>
                                <DropShadow Color="#000000" BlurRadius="4" ShadowDepth="0" Opacity="0.2"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource ButtonHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource ButtonPressedBrush}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AccentButton" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="18,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{StaticResource AccentBrush}" CornerRadius="12" BorderThickness="0">
                            <Border.Effect>
                                <DropShadow Color="#5865F2" BlurRadius="6" ShadowDepth="0" Opacity="0.4"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentBrushHover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentBrushPressed}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="18">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Style="{StaticResource CardBorderStyle}" Margin="0,0,0,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Vertical">
                    <TextBlock Text="GarticBot" FontSize="28" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Автоматический художник для Gartic Phone" Style="{StaticResource CaptionTextStyle}" Margin="0,4,0,0"/>
                    <TextBlock Text="by olive project team" FontSize="11" Foreground="#7A8298" Margin="0,8,0,0" FontStyle="Italic"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button x:Name="OnTopButton" Content="Поверх" Style="{StaticResource FlatButton}" MinWidth="110" Click="OnTopButton_Click" Margin="0,0,10,0"/>
                    <Button Content="Настройки" Style="{StaticResource FlatButton}" MinWidth="110" Click="SettingsButton_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <Border Grid.Row="1" Style="{StaticResource CardBorderStyle}">
            <StackPanel>
                <TextBlock Text="Источник изображения" Style="{StaticResource SectionTitleStyle}"/>
                <Grid Margin="0,12,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="imageUrlTextBox"
                             Style="{DynamicResource RoundedTextBox}"
                             Height="40"
                             FontSize="16"
                             Foreground="White"
                             Margin="0,0,12,0"
                             Tag="Введите URL картинки..."/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="URL" Style="{StaticResource FlatButton}" Padding="14,8" Click="DownloadImageFromURLButton" Margin="0,0,8,0"/>
                        <Button Content="Файл" Style="{StaticResource FlatButton}" Padding="14,8" Click="GetImageFromFIleButton" Margin="0,0,8,0"/>
                        <Button Content="Буфер" Style="{StaticResource FlatButton}" Padding="14,8" Click="GetImageFromClipboardButton"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.35*"/>
                <ColumnDefinition Width="18"/>
                <ColumnDefinition Width="0.65*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <Border Style="{StaticResource CardBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="Параметры рисования" Style="{StaticResource SectionTitleStyle}"/>
                        <CheckBox x:Name="GrayScaleCheckbox" Content="Чёрно-белый режим" Style="{DynamicResource RoundedCheckbox}" Checked="GrayScaleCheckbox_Checked" Unchecked="GrayScaleCheckbox_Checked" Margin="0,12,0,0"/>
                        <CheckBox x:Name="drawWithRectCheckbox" Content="Рисовать прямоугольниками" Style="{DynamicResource RoundedCheckbox}" Margin="0,12,0,0"/>
                        <Button Content="Область рисования" Style="{StaticResource FlatButton}" MinWidth="180" Click="DrawRectSelectButton_Click" Margin="0,12,0,0"/>
                    </StackPanel>
                </Border>

                <Border Style="{StaticResource CardBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="Скорость и шаг" Style="{StaticResource SectionTitleStyle}"/>
                        <TextBlock Text="Скорость" Style="{StaticResource CaptionTextStyle}" Margin="0,12,0,0"/>
                        <UniformGrid Columns="4" Margin="0,4,0,4">
                            <RadioButton x:Name="SpeedRadio1" Content="1" GroupName="SpeedGroup" Foreground="White" HorizontalAlignment="Center"/>
                            <RadioButton x:Name="SpeedRadio2" Content="2" GroupName="SpeedGroup" Foreground="White" HorizontalAlignment="Center"/>
                            <RadioButton x:Name="SpeedRadio3" Content="3" GroupName="SpeedGroup" Foreground="White" HorizontalAlignment="Center" IsChecked="True"/>
                            <RadioButton x:Name="SpeedRadio4" Content="4" GroupName="SpeedGroup" Foreground="White" HorizontalAlignment="Center"/>
                        </UniformGrid>
                        <StackPanel Margin="0,6,0,0">
                            <TextBlock x:Name="SpacingLabel" Text="пропуск (5)" Style="{StaticResource CaptionTextStyle}"/>
                            <Slider x:Name="SpacingSlider"
                                    Style="{DynamicResource CustomSlider}"
                                    Minimum="1"
                                    Maximum="12"
                                    Value="5"
                                    SmallChange="1"
                                    TickPlacement="None"
                                    ValueChanged="SpacingSlider_ValueChanged"
                                    Margin="0,6,0,0"/>
                        </StackPanel>
                        <StackPanel Margin="0,6,0,0">
                            <TextBlock x:Name="ContrastLabel" Text="контраст (0)" Style="{StaticResource CaptionTextStyle}"/>
                            <Slider x:Name="ContrastSlider"
                                    Style="{DynamicResource CustomSlider}"
                                    Minimum="-100"
                                    Maximum="100"
                                    SmallChange="1"
                                    ValueChanged="ContrastSlider_ValueChanged"
                                    Margin="0,6,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Style="{StaticResource CardBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="Цвета и масштаб" Style="{StaticResource SectionTitleStyle}"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,12,0,0">
                            <TextBlock Text="Цвета" Style="{StaticResource CaptionTextStyle}" VerticalAlignment="Center"/>
                            <TextBox x:Name="ColorCountInput"
                                     Style="{DynamicResource NumericInput}"
                                     Width="64"
                                     Height="36"
                                     FontSize="16"
                                     FontWeight="SemiBold"
                                     TextAlignment="Center"
                                     Text="16"
                                     Foreground="White"
                                     HorizontalContentAlignment="Center"
                                     PreviewTextInput="NumberValidationTextBox"
                                     TextChanged="ColorCountInput_TextChanged"
                                     Margin="10,0,0,0"/>
                            <StackPanel Orientation="Vertical" Margin="10,0,0,0">
                                <Button x:Name="colorsIncreaseButton" Content="▲" Style="{StaticResource FlatButton}" Width="44" Height="32" Padding="0" Click="colorsChangeButton_Click" Margin="0,0,0,6"/>
                                <Button x:Name="colorsDecreaseButton" Content="▼" Style="{StaticResource FlatButton}" Width="44" Height="32" Padding="0" Click="colorsChangeButton_Click"/>
                            </StackPanel>
                        </StackPanel>
                        <TextBlock Text="Масштаб изображения" Style="{StaticResource CaptionTextStyle}" Margin="0,12,0,0"/>
                        <ComboBox x:Name="imageSizeCombobox"
                                  Style="{DynamicResource theComboBox}"
                                  SelectedIndex="1"
                                  Height="32"
                                  SelectionChanged="imageSizeCombobox_SelectionChanged"
                                  Margin="0,12,0,0">
                            <ComboBoxItem Content="обычный"/>
                            <ComboBoxItem Content="вписать"/>
                            <ComboBoxItem Content="растянуть"/>
                            <ComboBoxItem Content="по-центру"/>
                        </ComboBox>
                    </StackPanel>
                </Border>
            </StackPanel>

            <Border Grid.Column="2" Style="{StaticResource CardBorderStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="Предпросмотр" Style="{StaticResource SectionTitleStyle}"/>
                    <Border Grid.Row="1" Background="#151A2B" CornerRadius="12" Padding="10">
                        <Image x:Name="previewImage" Stretch="Uniform"/>
                    </Border>
                    <ProgressBar x:Name="workProgressBar" Grid.Row="2" Height="12" Margin="0,16,0,0" Maximum="100" Foreground="{StaticResource AccentBrush}" Background="#1F2438"/>
                </Grid>
            </Border>
        </Grid>

        <Button Grid.Row="3"
                Content="Запустить"
                Style="{StaticResource AccentButton}"
                Margin="0,0,0,12"
                Click="StartButton_Click"/>

        <TextBlock Grid.Row="4"
                   x:Name="errorLabel"
                   Foreground="#FFED6A6A"
                   FontSize="14"
                   TextAlignment="Center"
                   Height="20"/>
    </Grid>
</Window>
